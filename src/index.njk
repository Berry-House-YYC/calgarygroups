---
layout: layouts/base.njk
title: Directory
---

{% set organizationsData %}
[
{% for org in collections.organizations %}
{
"name": {{ org.data.name | json | safe }},
"type": {{ org.data.type | json | safe }},
"interests": {{ (org.data.interests or []) | json | safe }},
"age_range": {{ org.data.age_range | json | safe }},
"identity_focused": {{ org.data.identity_focused | json | safe }},
"meeting_format": {{ org.data.meeting_format | json | safe }},
"location_area": {{ org.data.location_area | json | safe }},
"status": {{ org.data.status | json | safe }},
"website": {{ (org.templateContent | extractFirstUrl) | json | safe }},
"excerpt": {{ (org.templateContent | stripHtml | truncate(220) | unescape) | json | safe }},
"url": {{ org.url | json | safe }}
}{% if not loop.last %},{% endif %}
{% endfor %}
]
{% endset %}

<template id="organizations-data">
  {{ organizationsData | safe }}
</template>

<section class="h-feed space-y-6" x-data="directory(getOrganizations())">
  <!-- Welcome note - appears only on first visit -->
  <div x-data="{ 
    showWelcome: false,
    init() {
      // Check if this is the first visit
      const hasVisited = localStorage.getItem('calgary-groups-visited');
      if (!hasVisited) {
        this.showWelcome = true;
        // Mark as visited
        localStorage.setItem('calgary-groups-visited', 'true');
      }
    },
    close() {
      this.showWelcome = false;
    }
  }" x-show="showWelcome" x-transition:enter="transition ease-out duration-300" 
       x-transition:enter-start="opacity-0 transform -translate-y-2"
       x-transition:enter-end="opacity-100 transform translate-y-0"
       x-transition:leave="transition ease-in duration-200"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0"
       class="relative rounded-lg border border-slate-200 bg-gradient-to-br from-pink-100 via-purple-100 to-indigo-100 p-4 shadow-sm dark:border-brand-cyan/30 dark:from-purple-900/30 dark:via-pink-900/20 dark:to-indigo-900/30 dark:backdrop-blur-sm">
    <button type="button" @click="close()" 
            class="absolute right-2 top-2 rounded-md p-1 text-slate-400 hover:bg-slate-200/50 hover:text-slate-600 dark:hover:bg-slate-700/50 dark:hover:text-slate-300">
      <i class="fa-solid fa-times text-sm"></i>
    </button>
    <div class="pr-8">
      <p class="text-sm leading-relaxed text-slate-700 dark:text-slate-300">
        <span class="text-lg mr-2">(≧◡≦) ♡</span>
        Welcome! This is a <strong>free and accessible directory</strong> of a wide variety of different groups in Calgary. 
        Made with ♡ by 
        <span class="h-card vcard">
          <a href="https://brennanbrown.ca" class="u-url font-bold text-brand-orange hover:underline dark:text-cyan-400" target="_blank" rel="me noopener noreferrer">
            <span class="p-name fn">Brennan Kenneth Brown</span>
          </a>
        </span> and 
        <span class="h-card vcard">
          <a href="https://www.linkedin.com/in/yvonne-berger/" class="u-url font-bold text-brand-orange hover:underline dark:text-cyan-400" target="_blank" rel="me noopener noreferrer">
            <span class="p-name fn">Yvonne Berger</span>
          </a>
        </span> of 
        <span class="h-card vcard">
          <a href="https://berryhouse.ca" class="u-url font-bold text-brand-orange hover:underline dark:text-cyan-400" target="_blank" rel="me noopener noreferrer">
            <span class="p-name fn">Berry House</span>
          </a>
        </span>. 
        You can toggle any of the org types or interests to filter the directory. 
        <a href="/submit/" class="font-medium text-brand-orange hover:underline dark:text-cyan-400">Submit your own group here</a>!
      </p>
      <p class="mt-2 text-xs text-slate-600 dark:text-slate-400">
        (ﾉ>ω<)ﾉ :｡･:*:･'★,｡･:*:･' Go and do some good, today!~
      </p>
    </div>
  </div>

  <header class="space-y-2">
    <h1 class="inline-flex items-center gap-3 text-3xl font-semibold tracking-tight">
      <i aria-hidden="true" class="fa-solid fa-magnifying-glass text-brand-orange dark:text-brand-orange"></i>
      <span>Calgary Groups Directory</span>
    </h1>
    <p class="max-w-2xl text-slate-700 dark:text-slate-300">Search and filter grassroots organizations, clubs, activist
      groups, and community initiatives in Calgary.</p>
  </header>

  <div class="grid gap-4 xl:grid-cols-12">
    <aside class="min-w-0 xl:col-span-4">
      <div
        class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-brand-cyan/30 dark:bg-slate-800">
        <div class="flex items-center justify-between gap-2">
          <h2 class="text-base font-semibold">Filters</h2>
          <button type="button"
            class="rounded px-2 py-1 text-sm font-medium text-slate-700 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-brand-orange/50 dark:text-slate-200 dark:hover:bg-brand-cyan/10"
            @click="clearAll()">Clear</button>
        </div>

        <div class="mt-4">
          <label class="text-sm font-medium text-slate-900 dark:text-slate-100" for="search">Search</label>
          <input id="search" type="search"
            class="mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-brand-orange focus:outline-none focus:ring-2 focus:ring-brand-orange/20 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100 dark:focus:border-brand-cyan dark:focus:ring-brand-cyan/20"
            placeholder="Search by name or description" x-model.trim="q" @input.debounce.250ms="syncUrl()" />
        </div>

        <div class="mt-4" x-data="{ typeOpen: window.innerWidth >= 768 }">
          <button type="button"
            class="flex w-full items-center justify-between rounded-lg px-3 py-2 text-left text-sm font-semibold text-slate-900 transition-colors hover:bg-slate-100 md:px-0 md:py-0 md:hover:bg-transparent md:hover:text-brand-orange dark:text-slate-100 dark:hover:bg-brand-cyan/10 md:dark:hover:bg-transparent md:dark:hover:text-brand-cyan"
            @click="typeOpen = !typeOpen">
            <span class="flex items-center gap-2">
              <i aria-hidden="true" class="fa-solid fa-filter text-xs md:hidden"></i>
              <span>Type</span>
            </span>
            <i aria-hidden="true" class="fa-solid fa-chevron-down text-xs transition-transform"
              :class="{ 'rotate-180': typeOpen }"></i>
          </button>
          <div x-show="typeOpen" x-collapse class="mt-2 space-y-2 text-sm">
            <template x-for="t in typeOptions" :key="t">
              <label class="flex min-w-0 items-center gap-2">
                <input type="checkbox"
                  class="h-4 w-4 rounded border-slate-300 text-brand-orange focus:ring-brand-orange/50 dark:border-slate-700 dark:bg-slate-950 dark:text-brand-cyan dark:focus:ring-brand-cyan/50"
                  :value="t" x-model="selectedTypes" @change="syncUrl()" />
                <i aria-hidden="true" class="shrink-0" :class="[typeMeta(t).icon, typeMeta(t).iconColor]"></i>
                <span class="min-w-0 break-words" x-text="typeMeta(t).label"></span>
              </label>
            </template>
          </div>
        </div>

        <div class="mt-4" x-data="{ interestsOpen: window.innerWidth >= 768 }">
          <button type="button"
            class="flex w-full items-center justify-between rounded-lg px-3 py-2 text-left text-sm font-semibold text-slate-900 transition-colors hover:bg-slate-100 md:px-0 md:py-0 md:hover:bg-transparent md:hover:text-brand-orange dark:text-slate-100 dark:hover:bg-brand-cyan/10 md:dark:hover:bg-transparent md:dark:hover:text-brand-cyan"
            @click="interestsOpen = !interestsOpen">
            <span class="flex items-center gap-2">
              <i aria-hidden="true" class="fa-solid fa-filter text-xs md:hidden"></i>
              <span>Interests</span>
            </span>
            <i aria-hidden="true" class="fa-solid fa-chevron-down text-xs transition-transform"
              :class="{ 'rotate-180': interestsOpen }"></i>
          </button>
          <div x-show="interestsOpen" x-collapse class="mt-2 grid grid-cols-1 gap-2 text-sm sm:grid-cols-2">
            <template x-for="i in interestOptions" :key="i">
              <label class="flex min-w-0 items-center gap-2">
                <input type="checkbox"
                  class="h-4 w-4 rounded border-slate-300 text-brand-orange focus:ring-brand-orange/50 dark:border-slate-700 dark:bg-slate-950 dark:text-brand-cyan dark:focus:ring-brand-cyan/50"
                  :value="i" x-model="selectedInterests" @change="syncUrl()" />
                <i aria-hidden="true" class="shrink-0" :class="[interestMeta(i).icon, interestMeta(i).iconColor]"></i>
                <span class="min-w-0 break-words" x-text="interestMeta(i).label"></span>
              </label>
            </template>
          </div>
        </div>

        <fieldset class="mt-4">
          <legend class="text-sm font-medium text-slate-900 dark:text-slate-100">Interest matching</legend>
          <div class="mt-2 flex flex-wrap gap-3 text-sm">
            <label class="flex min-w-0 items-center gap-2">
              <input type="radio"
                class="h-4 w-4 border-slate-300 text-brand-orange focus:ring-brand-orange/50 dark:border-slate-700 dark:bg-slate-950 dark:text-brand-cyan dark:focus:ring-brand-cyan/50"
                name="interestMode" value="any" x-model="interestMode" @change="syncUrl()" />
              <span class="min-w-0 break-words">Match any</span>
            </label>
            <label class="flex min-w-0 items-center gap-2">
              <input type="radio"
                class="h-4 w-4 border-slate-300 text-brand-orange focus:ring-brand-orange/50 dark:border-slate-700 dark:bg-slate-950 dark:text-brand-cyan dark:focus:ring-brand-cyan/50"
                name="interestMode" value="all" x-model="interestMode" @change="syncUrl()" />
              <span class="min-w-0 break-words">Match all</span>
            </label>
          </div>
        </fieldset>

        <!-- <div class="mt-4">
          <p class="text-sm font-medium text-slate-900 dark:text-slate-100">Meeting format</p>
          <select
            class="mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-brand-orange focus:outline-none focus:ring-2 focus:ring-brand-orange/20 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100 dark:focus:border-brand-cyan dark:focus:ring-brand-cyan/20"
            x-model="meetingFormat" @change="syncUrl()">
            <option value="">Any</option>
            <template x-for="m in meetingFormatOptions" :key="m">
              <option :value="m" x-text="m"></option>
            </template>
          </select>
        </div> -->

        <!-- <div class="mt-4">
          <p class="text-sm font-medium text-slate-900 dark:text-slate-100">Location</p>
          <select
            class="mt-1 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-brand-orange focus:outline-none focus:ring-2 focus:ring-brand-orange/20 dark:border-slate-700 dark:bg-slate-950 dark:text-slate-100 dark:focus:border-brand-cyan dark:focus:ring-brand-cyan/20"
            x-model="locationArea" @change="syncUrl()">
            <option value="">Any</option>
            <template x-for="l in locationAreaOptions" :key="l">
              <option :value="l" x-text="l"></option>
            </template>
          </select>
        </div> -->

        <div class="mt-4">
          <label class="flex items-center gap-2 text-sm">
            <input type="checkbox"
              class="h-4 w-4 rounded border-slate-300 text-brand-orange focus:ring-brand-orange/50 dark:border-slate-700 dark:bg-slate-950 dark:text-brand-cyan dark:focus:ring-brand-cyan/50"
              x-model="identityFocused" @change="syncUrl()" />
            <span class="font-medium text-slate-900 dark:text-slate-100">Identity-focused</span>
          </label>
        </div>

        <div class="mt-4 rounded-md bg-slate-50 px-3 py-2 text-sm text-slate-700 dark:bg-slate-700 dark:text-slate-200"
          aria-live="polite">
          <span class="font-medium" x-text="filtered.length"></span>
          <span>results</span>
        </div>
      </div>
    </aside>

    <div class="min-w-0 xl:col-span-8">
      <h2 class="sr-only">Search Results</h2>
      <div class="grid gap-4 md:grid-cols-2">
        <template x-for="org in filtered" :key="org.url">
          <article
            class="h-entry h-as-org min-w-0 overflow-hidden rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-brand-cyan/30 dark:bg-slate-800">
            <div class="flex min-w-0 flex-wrap items-start gap-3">
              <h2 class="min-w-0 flex-1 break-words text-lg font-semibold leading-snug">
                <template x-if="org.website">
                  <a class="p-name u-url block break-words rounded hover:underline focus:outline-none focus:ring-2 focus:ring-brand-orange/50 dark:focus:ring-brand-cyan/50"
                    :href="org.website" target="_blank" rel="noopener noreferrer" x-text="org.name"></a>
                </template>
                <template x-if="!org.website">
                  <a class="p-name u-url block break-words rounded hover:underline focus:outline-none focus:ring-2 focus:ring-brand-orange/50 dark:focus:ring-brand-cyan/50"
                    :href="org.url" x-text="org.name"></a>
                </template>
              </h2>
              <span
                class="inline-flex min-w-0 items-center gap-2 rounded-full px-3 py-1 text-xs font-medium ring-1 ring-inset"
                :class="typeMeta(org.type).pill">
                <i aria-hidden="true" :class="typeMeta(org.type).icon"></i>
                <span class="min-w-0 break-words" x-text="typeMeta(org.type).label"></span>
              </span>
            </div>
            <p class="p-summary mt-2 break-words text-sm text-slate-700 dark:text-slate-300" x-text="org.excerpt"></p>
            <div class="mt-3 flex flex-wrap gap-2">
              <template x-for="tag in (org.interests || []).slice(0, 3)" :key="tag">
                <span
                  class="inline-flex min-w-0 items-center gap-2 rounded-full px-2 py-1 text-xs font-medium ring-1 ring-inset"
                  :class="interestMeta(tag).pill">
                  <i aria-hidden="true" :class="interestMeta(tag).icon"></i>
                  <span class="min-w-0 break-words" x-text="interestMeta(tag).label"></span>
                </span>
              </template>
            </div>

            <div class="mt-4">
              <a class="fun-link inline-flex items-center gap-2 text-sm font-medium text-brand-orange hover:bg-brand-orange/10 dark:text-cyan-400 dark:hover:bg-cyan-400/10"
                :href="org.url">
                <span>Learn More</span>
                <span aria-hidden="true">→</span>
              </a>
            </div>
          </article>
        </template>
      </div>

      <div
        class="mt-6 rounded-lg border border-slate-200 bg-white p-6 text-sm text-slate-700 shadow-sm dark:border-brand-cyan/30 dark:bg-slate-800 dark:text-slate-300"
        x-show="filtered.length === 0" x-cloak>
        <p class="font-medium text-slate-900 dark:text-slate-100">No results</p>
        <p class="mt-1">Try clearing filters or using a broader search.</p>
      </div>
    </div>
  </div>
</section>

<script>
  function getOrganizations() {
    const el = document.getElementById("organizations-data");
    if (!el) return [];
    try {
      return JSON.parse(el.innerHTML || "[]");
    } catch {
      return [];
    }
  }

  function directory(initialOrganizations) {
    return {
      organizations: Array.isArray(initialOrganizations) ? initialOrganizations : [],
      q: "",
      selectedTypes: [],
      selectedInterests: [],
      interestMode: "any",
      meetingFormat: "",
      locationArea: "",
      identityFocused: false,
      typeStyles: {
        "Nonprofit": {
          label: "Nonprofit",
          icon: "fa-solid fa-hand-holding-heart",
          iconColor: "text-blue-700 dark:text-blue-400",
          pill: "bg-blue-50 text-blue-800 ring-blue-200"
        },
        "Grassroots": {
          label: "Grassroots",
          icon: "fa-solid fa-seedling",
          iconColor: "text-emerald-600 dark:text-emerald-400",
          pill: "bg-emerald-50 text-emerald-800 ring-emerald-200"
        },
        "Social Club": {
          label: "Social Club",
          icon: "fa-solid fa-user-group",
          iconColor: "text-purple-600 dark:text-purple-400",
          pill: "bg-purple-50 text-purple-800 ring-purple-200"
        },
        "Chapter": {
          label: "Chapter",
          icon: "fa-solid fa-network-wired",
          iconColor: "text-indigo-600 dark:text-indigo-400",
          pill: "bg-indigo-50 text-indigo-800 ring-indigo-200"
        },
        "Cooperative": {
          label: "Cooperative",
          icon: "fa-solid fa-handshake",
          iconColor: "text-teal-700 dark:text-teal-400",
          pill: "bg-teal-50 text-teal-800 ring-teal-200"
        },
        "Small Business": {
          label: "Small Business",
          icon: "fa-solid fa-store",
          iconColor: "text-amber-700 dark:text-amber-400",
          pill: "bg-amber-50 text-amber-800 ring-amber-200"
        }
      },
      interestStyles: {
        "anti-racism": {
          label: "Anti-Racism",
          icon: "fa-solid fa-hand-fist",
          iconColor: "text-amber-800 dark:text-amber-400",
          pill: "bg-amber-100 text-amber-900 ring-amber-200"
        },
        "arts-culture": {
          label: "Arts & Culture",
          icon: "fa-solid fa-palette",
          iconColor: "text-fuchsia-700 dark:text-fuchsia-400",
          pill: "bg-fuchsia-50 text-fuchsia-800 ring-fuchsia-200"
        },
        "disability/neurodivergent": {
          label: "Disability/Neurodivergent",
          icon: "fa-solid fa-universal-access",
          iconColor: "text-violet-700 dark:text-violet-400",
          pill: "bg-violet-50 text-violet-800 ring-violet-200"
        },
        "education": {
          label: "Education",
          icon: "fa-solid fa-graduation-cap",
          iconColor: "text-sky-700 dark:text-sky-400",
          pill: "bg-sky-50 text-sky-800 ring-sky-200"
        },
        "environment": {
          label: "Environment",
          icon: "fa-solid fa-leaf",
          iconColor: "text-green-700 dark:text-green-400",
          pill: "bg-green-50 text-green-800 ring-green-200"
        },
        "health-wellness": {
          label: "Health & Wellness",
          icon: "fa-solid fa-heart-pulse",
          iconColor: "text-rose-700 dark:text-rose-400",
          pill: "bg-rose-50 text-rose-800 ring-rose-200"
        },
        "indigenous": {
          label: "Indigenous",
          icon: "fa-solid fa-feather",
          iconColor: "text-orange-800 dark:text-orange-400",
          pill: "bg-orange-50 text-orange-900 ring-orange-200"
        },
        "international": {
          label: "International",
          icon: "fa-solid fa-globe",
          iconColor: "text-slate-900 dark:text-slate-100",
          pill: "bg-gradient-to-r from-blue-200 via-cyan-200 to-teal-200 text-slate-900 ring-slate-200"
        },
        "lgbtq2s": {
          label: "LGBTQ2S+",
          icon: "fa-solid fa-flag",
          iconColor: "text-slate-900 dark:text-slate-100",
          pill: "bg-gradient-to-r from-rose-200 via-amber-200 to-sky-200 text-slate-900 ring-slate-200"
        },
        "low-income": {
          label: "Low-income",
          icon: "fa-solid fa-hand-holding-dollar",
          iconColor: "text-lime-800 dark:text-lime-400",
          pill: "bg-lime-50 text-lime-900 ring-lime-200"
        },
        "seniors": {
          label: "Seniors",
          icon: "fa-solid fa-person-cane",
          iconColor: "text-stone-700 dark:text-stone-400",
          pill: "bg-stone-50 text-stone-800 ring-stone-200"
        },
        "social-impact": {
          label: "Social Impact",
          icon: "fa-solid fa-hands-holding-circle",
          iconColor: "text-cyan-700 dark:text-cyan-400",
          pill: "bg-cyan-50 text-cyan-800 ring-cyan-200"
        },
        "sports-rec": {
          label: "Sports & Rec",
          icon: "fa-solid fa-dumbbell",
          iconColor: "text-orange-700 dark:text-orange-400",
          pill: "bg-orange-50 text-orange-800 ring-orange-200"
        },
        "tech": {
          label: "Tech",
          icon: "fa-solid fa-microchip",
          iconColor: "text-slate-700 dark:text-slate-400",
          pill: "bg-slate-50 text-slate-800 ring-slate-200"
        },
        "urban-issues": {
          label: "Urban Issues",
          icon: "fa-solid fa-city",
          iconColor: "text-zinc-700 dark:text-zinc-400",
          pill: "bg-zinc-50 text-zinc-800 ring-zinc-200"
        },
        "women+": {
          label: "Women+",
          icon: "fa-solid fa-venus",
          iconColor: "text-pink-700 dark:text-pink-400",
          pill: "bg-pink-50 text-pink-800 ring-pink-200"
        },
        "youth": {
          label: "Youth",
          icon: "fa-solid fa-child-reaching",
          iconColor: "text-indigo-700 dark:text-indigo-400",
          pill: "bg-indigo-50 text-indigo-800 ring-indigo-200"
        },
        "book": {
          label: "Book Clubs",
          icon: "fa-solid fa-book",
          iconColor: "text-brown-700 dark:text-brown-400",
          pill: "bg-amber-50 text-amber-900 ring-amber-300"
        },
        "general": {
          label: "General",
          icon: "fa-solid fa-users",
          iconColor: "text-gray-700 dark:text-gray-400",
          pill: "bg-gray-50 text-gray-800 ring-gray-200"
        }
      },
      init() {
        this.hydrateFromUrl();
      },
      typeMeta(value) {
        return this.typeStyles[value] || { label: value || "", icon: "fa-regular fa-circle", iconColor: "text-slate-500", pill: "bg-slate-100 text-slate-800 ring-slate-200" };
      },
      interestMeta(value) {
        return this.interestStyles[value] || { label: value || "", icon: "fa-regular fa-circle", iconColor: "text-slate-500", pill: "bg-slate-100 text-slate-800 ring-slate-200" };
      },
      get typeOptions() {
        return [...new Set(this.organizations.map((o) => o.type).filter(Boolean))].sort();
      },
      get interestOptions() {
        const all = [];
        for (const org of this.organizations) {
          for (const tag of org.interests || []) all.push(tag);
        }
        return [...new Set(all.filter(Boolean))].sort();
      },
      get meetingFormatOptions() {
        return [...new Set(this.organizations.map((o) => o.meeting_format).filter(Boolean))].sort();
      },
      get locationAreaOptions() {
        return [...new Set(this.organizations.map((o) => o.location_area).filter(Boolean))].sort();
      },
      get filtered() {
        const q = (this.q || "").toLowerCase();
        return this.organizations.filter((org) => {
          if (q) {
            const haystack = `${org.name || ""} ${org.excerpt || ""}`.toLowerCase();
            if (!haystack.includes(q)) return false;
          }

          if (this.selectedTypes.length > 0 && !this.selectedTypes.includes(org.type)) return false;

          if (this.selectedInterests.length > 0) {
            const orgTags = Array.isArray(org.interests) ? org.interests : [];
            const ok = this.interestMode === "all"
              ? this.selectedInterests.every((t) => orgTags.includes(t))
              : this.selectedInterests.some((t) => orgTags.includes(t));
            if (!ok) return false;
          }

          if (this.meetingFormat && org.meeting_format !== this.meetingFormat) return false;
          if (this.locationArea && org.location_area !== this.locationArea) return false;

          if (this.identityFocused) {
            if (!org.identity_focused) return false;
          }

          return true;
        });
      },
      clearAll() {
        this.q = "";
        this.selectedTypes = [];
        this.selectedInterests = [];
        this.interestMode = "any";
        this.meetingFormat = "";
        this.locationArea = "";
        this.identityFocused = false;
        this.syncUrl();
      },
      hydrateFromUrl() {
        const params = new URLSearchParams(window.location.search);
        this.q = params.get("q") || "";
        this.selectedTypes = params.getAll("type");
        this.selectedInterests = params.getAll("interest");
        this.interestMode = params.get("interestMode") === "all" ? "all" : "any";
        this.meetingFormat = params.get("format") || "";
        this.locationArea = params.get("location") || "";
        this.identityFocused = params.get("identity") === "1";
      },
      syncUrl() {
        const params = new URLSearchParams();
        if (this.q) params.set("q", this.q);
        for (const t of this.selectedTypes) params.append("type", t);
        for (const i of this.selectedInterests) params.append("interest", i);
        if (this.interestMode === "all") params.set("interestMode", "all");
        if (this.meetingFormat) params.set("format", this.meetingFormat);
        if (this.locationArea) params.set("location", this.locationArea);
        if (this.identityFocused) params.set("identity", "1");
        const qs = params.toString();
        const url = qs ? `${window.location.pathname}?${qs}` : window.location.pathname;
        window.history.replaceState(null, "", url);
      }
    };
  }
</script>